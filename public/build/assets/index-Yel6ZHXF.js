import{Q as re,d as g,p as W,o as r,e as a,a as e,j as y,l as J,v as h,f as u,g as P,t as d,F as C,h as B,n as ne,b as H,u as M,z as S,D as ie,k as de,c as ue,w as ce}from"./app-DPV_GV2A.js";import{S as D,_ as pe}from"./AppLayout-Bf8rsGcf.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as ve}from"./createLucideIcon-DaVZ2mUS.js";/**
 * @license lucide-vue-next v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=ve("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),fe={class:"min-h-screen pt-10 no-print"},xe={class:"max-w-5xl mx-auto bg-white rounded-lg p-1"},me={class:"mb-6 border-b pb-4"},be={class:"flex gap-5 justify-between items-center flex-col md:flex-row"},ye={class:"flex gap-4 items-center no-print"},he={key:0,class:"flex flex-col gap-2 items-center"},_e={class:"flex flex-col md:flex-row gap-3 items-center"},we={class:"flex gap-5"},ke={class:"grid grid-cols-2 gap-4"},$e={class:"capitalize"},Ce={class:"border-b border-gray-200 overflow-scroll"},Se={class:"-mb-px flex space-x-8"},Ee=["onClick"],Te={class:"mt-6 overflow-scroll"},Ve={class:"min-w-full divide-y divide-gray-200"},Ie={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ue={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ne={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Be={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},ze={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},je={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ae={class:"bg-white divide-y divide-gray-200"},De={key:0},Ge={class:"px-6 py-4 whitespace-nowrap"},Fe={key:0,class:"flex gap-2"},Le=["onUpdate:modelValue"],Me=["onClick"],Pe={class:"ml-5 text-sm text-gray-500"},He={key:0,class:"px-6 py-4"},Re={key:1,class:"px-6 py-4"},Oe=["onUpdate:modelValue","onInput"],qe={key:1},Qe={key:2,class:"px-6 py-4 font-medium"},Xe={key:3,class:"px-6 py-4"},We={key:4,class:"px-6 py-4"},Je={key:5,class:"px-6 py-4"},Ke=["onUpdate:modelValue"],Ye={key:0,class:"mt-6 flex justify-end"},Ze=["disabled"],et={key:1,class:"mt-6 flex justify-end no-print"},tt=["disabled"],ot=["disabled"],st={id:"print-all",class:"print-all-tabs"},rt={class:"mb-8"},at={class:"text-xl font-bold mb-4 capitalize"},lt={class:"min-w-full divide-y divide-gray-200"},nt={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},it={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},dt={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},ut={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},ct={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},pt={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},gt={class:"px-6 py-4 whitespace-nowrap"},vt={key:0,class:"flex gap-2"},ft={class:"w-48"},xt={class:"ml-5 text-sm text-gray-500"},mt={key:0,class:"px-6 py-4"},bt={key:1,class:"px-6 py-4"},yt=["onUpdate:modelValue","onInput"],ht={key:1},_t={key:2,class:"px-6 py-4 font-medium"},wt={key:3,class:"px-6 py-4"},kt={key:4,class:"px-6 py-4"},$t={key:5,class:"px-6 py-4"},Ct={class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},St={__name:"RegistroInventario",setup(K){const{props:f}=re(),z=(s,o)=>{D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:"no-print",didOpen:t=>{t.addEventListener("mouseenter",D.stopTimer),t.addEventListener("mouseleave",D.resumeTimer)}}).fire({icon:s,title:o})},w=g(null),U=g(null),G=g(null),E=g("day"),j=g(f.inventario),T=g(f.registros),_=g(f.gastos||[]),R=g(f.categorias),n=g("bebida"),m=g(!1),O=g(f.user.roles[0]==="almacen"),v=g(!1),q=()=>{w.value=null,U.value=null,G.value=null,v.value=!1,S.get("/inventario",{},{preserveScroll:!0})},p=()=>{let s=E.value,o=null;if(s==="day"?o=w.value:s==="week"?o=U.value:s==="month"&&(o=G.value),!o){z("error","Debes seleccionar una fecha");return}S.post("/inventario/filtro",{filter:s,value:o},{preserveScroll:!0,onSuccess(t){console.log("Respuesta completa del servidor:",t.props),T.value=t.props.registros,j.value=t.props.inventario,_.value=t.props.gastos,k.value=j.value.filter(b=>b.nombre!=="-").map(b=>{var I,Y,Z,ee,te,oe;return{...b,existe:((I=t.props.registros[b.id-1])==null?void 0:I.existe)||0,entra:((Y=t.props.registros[b.id-1])==null?void 0:Y.entra)||0,total:((Z=t.props.registros[b.id-1])==null?void 0:Z.total)||0,vende:((ee=t.props.registros[b.id-1])==null?void 0:ee.vende)||0,sobra:((te=t.props.registros[b.id-1])==null?void 0:te.sobra)||0,costo:((oe=t.props.registros[b.id-1])==null?void 0:oe.costo)||0}}),v.value=!0,z("success","Filtro actualizado correctamente")},onError(t){console.error("Error al obtener datos:",t),z("error",t.props.flash.error||"Error al obtener datos con este filtro"),error.value="Ocurrió un error al obtener los datos. Inténtalo de nuevo.",isLoading.value=!1}})},N=W(()=>{var s,o;return console.log("Filtrando productos con activeTab:",n.value),n.value==="gastos"?_.value:n.value==="pastes"||n.value==="sobrantes"?(s=k==null?void 0:k.value)==null?void 0:s.filter(t=>t.tipo==="pastes"||t.tipo==="empanadas saladas"||t.tipo==="empanadas dulces"):(o=k==null?void 0:k.value)==null?void 0:o.filter(t=>t.tipo===n.value)});async function F(){try{m.value=!0;const s={sobrantes:k.value.filter(o=>o.existe>0).map(o=>({inventario_id:o.id,sucursal_id:f.sucursal_id,nombre:o.nombre,cantidad:o.existe}))};S.post("/sobrantes",s,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{Toast.fire({icon:"success",title:"Sobrantes guardados exitosamente"})},onError:o=>{console.error("Error al guardar sobrantes:",o),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}})}catch(s){console.error("Error al guardar sobrantes:",s),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}finally{m.value=!1}}function Q(){_.value.push({nombre:"",costo:0})}function x(s){_.value.splice(s,1)}const X=[...R.value.filter(s=>s.tipo!=="empanadas saladas"&&s.tipo!=="empanadas dulces").map(s=>s.tipo==="masa"?{name:"Tortillas y Bolas",id:s.tipo}:s.tipo==="pastes"?{name:"Pastes / Empanadas",id:s.tipo}:{id:s.tipo,name:s.tipo}),...O.value?[]:[{id:"gastos",name:"Gastos generales"},{id:"sobrantes",name:"Sobrantes"}]],k=g(j.value.filter(s=>s.nombre!=="-").map(s=>{var o,t;return{...s,existe:((o=T.value[s.id-1])==null?void 0:o.existe)||(s==null?void 0:s.existe)||0,entra:0,total:null,sobra:(t=T.value[s.id-1])==null?void 0:t.existe,costo:(s==null?void 0:s.costo)||0}})),L=W(()=>n.value==="bebida"||n.value==="extras"||n.value==="pastes"),$=s=>{const o=f.ventas.find(t=>t.producto_id===s);return o?o.total_vendido:0},A=s=>v.value?s.total:i(s)+($(s)||0)+s.entra,c=s=>v.value?s.sobra:A(s)-$(s.id),l=s=>{s.total=(s.existe||0)+(s.entra||0);const o=$(s.id);s.sobra=s.total-o};function i(s){const o=$(s.id);return v.value?s.existe+Number(o):s.cantidad+Number(o)}async function V(){try{m.value=!0;const s={gastos:_.value.map(o=>({id:o.id||null,sucursal_id:o.sucursal_id||0,nombre:o.nombre,costo:o.costo||0}))};S.post("/gastos",s,{preserveScroll:!0,preserveState:!1,onSuccess:o=>{Toast.fire({icon:"success",title:"Gastos guardados exitosamente"}),n.value="gastos",_.value=o.props.gastos},onError:o=>{console.error("Error al guardar:",o),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}})}catch(s){console.error("Error al guardar:",s),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}finally{m.value=!1}}async function ae(){try{m.value=!0;const s={productos:k.value.map(o=>({id:o.id,existe:o.existe||0,entra:o.entra||0,total:A(o),vende:Number($(o.id)),costo:o.costo||0,sobra:c(o)}))};S.post("/registro",{registros:s},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:()=>{console.log("Registro guardado exitosamente")},onError:o=>{console.error("Error al guardar:",o)}}),Toast.fire({icon:"success",title:"Registro guardado exitosamente"})}catch(s){console.error("Error al guardar:",s),Toast.fire({icon:"error",title:"Error al guardar el registro"})}finally{m.value=!1}}const le=()=>{window.print()};return(s,o)=>(r(),a(C,null,[e("div",fe,[e("div",xe,[e("div",me,[e("div",be,[o[8]||(o[8]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Registro de Inventario",-1)),e("div",ye,[s.$page.props.user.roles[0]!="trabajador"?(r(),a("div",he,[e("div",_e,[o[6]||(o[6]=e("label",{for:"fecha"},"Buscar por:",-1)),e("div",we,[y(e("select",{class:"rounded",id:"filter","onUpdate:modelValue":o[0]||(o[0]=t=>E.value=t)},o[5]||(o[5]=[e("option",{value:"day"},"Día",-1),e("option",{value:"week"},"Semana",-1),e("option",{value:"month"},"Mes",-1)]),512),[[J,E.value]]),E.value==="day"?y((r(),a("input",{key:0,class:"w-fit h-fit rounded",id:"valueSelect",type:"date","onUpdate:modelValue":o[1]||(o[1]=t=>w.value=t)},null,512)),[[h,w.value]]):u("",!0),E.value==="week"?y((r(),a("input",{key:1,class:"w-fit h-fit rounded",id:"valueSelect",type:"week","onUpdate:modelValue":o[2]||(o[2]=t=>U.value=t)},null,512)),[[h,U.value]]):u("",!0),E.value==="month"?y((r(),a("input",{key:2,class:"w-fit h-fit rounded",id:"valueSelect",type:"month","onUpdate:modelValue":o[3]||(o[3]=t=>G.value=t)},null,512)),[[h,G.value]]):u("",!0)])]),e("div",ke,[e("button",{onClick:p,class:"no-print bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Buscar"),e("button",{onClick:q,class:"no-print bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Limpiar filtro"),e("button",{onClick:le,class:"bg-green-500 text-white px-4 py-2 rounded no-print"},[o[7]||(o[7]=P(" Imprimir inventario - ")),e("span",$e,d(n.value),1)])])])):u("",!0)])])]),e("div",Ce,[e("nav",Se,[(r(),a(C,null,B(X,t=>e("button",{key:t.id,onClick:b=>n.value=t.id,class:ne(["whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize",n.value===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},d(t.name),11,Ee)),64))])]),e("div",Te,[e("table",Ve,[e("thead",null,[e("tr",null,[o[9]||(o[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",Ie," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ue," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ne," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Be," Total ")):u("",!0),L.value?(r(),a("th",ze," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",je," Sobra ")):u("",!0)])]),e("tbody",Ae,[n.value==="gastos"?(r(),a("tr",De,[e("td",{colspan:"2",class:"px-6 py-4"},[e("div",{class:""},[e("button",{onClick:Q,class:"text-blue-600 hover:text-blue-800"}," + Agregar nuevo gasto ")])])])):u("",!0),(r(!0),a(C,null,B(N.value,(t,b)=>(r(),a("tr",{key:b},[e("td",Ge,[n.value==="gastos"?(r(),a("div",Fe,[y(e("input",{type:"text","onUpdate:modelValue":I=>t.nombre=I,class:"w-48 rounded-md border-gray-300 shadow-sm",placeholder:"Nombre del gasto"},null,8,Le),[[h,t.nombre]]),e("button",{onClick:I=>x(b),class:"text-red-600 no-print hover:text-red-800"},[H(M(se),{class:"no-print"})],8,Me)])):(r(),a(C,{key:1},[e("h1",null,d(t.nombre),1),e("span",Pe,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",He,d(v.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Re,[v.value?(r(),a("div",qe,d(v.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":I=>t.entra=I,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:I=>l(t)},null,40,Oe)),[[h,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Qe,d(v.value?t.total:A(t)),1)):u("",!0),L.value&&n.value!=="sobrantes"?(r(),a("td",Xe,d(v.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",We,d(v.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",Je,[y(e("input",{"onUpdate:modelValue":I=>t.costo=I,type:"number",min:"0",placeholder:"0",class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},null,8,Ke),[[h,t.costo,void 0,{number:!0}]])])):u("",!0)]))),128))])])]),n.value==="sobrantes"?(r(),a("div",Ye,[e("button",{onClick:F,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:m.value},d(m.value?"Guardando...":"Guardar Sobrantes"),9,Ze)])):(r(),a("div",et,[n.value==="gastos"?(r(),a("button",{key:0,onClick:V,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:m.value},d(m.value?"Guardando...":"Guardar Gastos"),9,tt)):(r(),a("button",{key:1,onClick:ae,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:m.value},d(m.value?"Guardando...":"Guardar Registro"),9,ot))]))])]),e("div",st,[e("div",rt,[e("h2",at,d(n.value),1),e("table",lt,[e("thead",null,[e("tr",null,[o[10]||(o[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",nt," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",it," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",dt," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",ut," Total ")):u("",!0),L.value?(r(),a("th",ct," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",pt," Sobra ")):u("",!0)])]),e("tbody",null,[(r(!0),a(C,null,B(N.value,t=>(r(),a("tr",{key:t.index},[e("td",gt,[n.value==="gastos"?(r(),a("div",vt,[e("span",ft,d(t.nombre),1),e("button",{onClick:o[4]||(o[4]=b=>x(s.index)),class:"text-red-600 hover:text-red-800"},[H(M(se),{class:"no-print"})])])):(r(),a(C,{key:1},[e("h1",null,d(t.nombre),1),e("span",xt,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",mt,d(v.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",bt,[v.value?(r(),a("div",ht,d(v.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":b=>t.entra=b,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:b=>l(t)},null,40,yt)),[[h,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",_t,d(v.value?t.total:A(t)),1)):u("",!0),L.value&&n.value!=="sobrantes"?(r(),a("td",wt,d(v.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",kt,d(v.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",$t,[e("span",Ct,d(t.costo),1)])):u("",!0)]))),128))])])])])],64))}},Et=ge(St,[["__scopeId","data-v-717e117d"]]),Tt={class:"container mx-auto p-8 md:p-10"},Vt={class:"space-y-4 mb-5 no-print"},It={class:"flex justify-between items-center"},Ut={class:"flex items-center space-x-2"},Nt={class:"text-lg font-semibold text-gray-800"},Bt={class:"text-gray-600 text-sm"},zt={class:"text-gray-600 text-sm"},jt={class:"font-medium text-gray-800 capitalize"},At={class:"text-sm text-gray-700"},Dt={class:"mt-2 space-y-1"},Gt={class:"text-sm text-gray-700 space-y-1 pl-4 list-disc"},Ft={key:0,class:"text-xs"},Lt={class:"flex justify-end"},Mt=["onClick"],Pt={key:0,class:"no-print flex flex-col md:flex-row gap-10 w-full"},Ht={class:"md:w-4/12 w-full"},Rt={class:"bg-white shadow rounded-lg p-6 mb-6"},Ot={class:"text-xl font-semibold mb-4"},qt=["value"],Qt={class:"flex justify-end space-x-2"},Xt={type:"submit",class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},Wt={key:0,class:"w-full"},Jt={class:"md:w-8/12 w-full"},Kt={class:"mb-4"},Yt={class:"bg-white shadow rounded-lg overflow-auto h-screen"},Zt={class:"min-w-full divide-y divide-gray-200"},eo={class:"bg-white divide-y divide-gray-200"},to={class:"py-1 px-2 whitespace bg-gray-50"},oo={class:"py-1 px-2 whitespace-nowrap"},so={class:"py-1 px-2 whitespace bg-gray-50"},ro={class:"py-1 px-2 whitespace-nowrap"},ao={class:"py-1 px-2 whitespace-nowrap bg-gray-50"},lo={class:"py-1 px-2 whitespace-nowrap text-sm font-medium flex flex-col gap-1 place-items-center"},no=["onClick"],io=["onClick"],uo={key:1,class:"no-print fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},co={class:"bg-white p-6 rounded-lg shadow-lg w-96"},po={key:2,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},go={class:"bg-white p-6 rounded-lg shadow-lg w-96"},vo=["value"],fo={__name:"Inventario",setup(K){var A;const{props:f}=re(),z=g(f.tickets),w=g((A=f==null?void 0:f.inventario)==null?void 0:A.filter(c=>c.nombre!="-")),U=g(f.categorias),G=g(f.user.roles[0]==="almacen"),E=g(!1),j=g(!1),T=g(),_=g(""),R=()=>{E.value=!0},n=()=>{j.value=!0},m=()=>{E.value=!1,j.value=!1,_.value=""},O=()=>{_.value.trim()?(S.post("/categorias",{tipo:_.value},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Categoría agregada correctamente"}),U.value=c.props.categorias},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar la categoría"})}}),m()):x.fire({icon:"error",title:"Por favor, ingresa un nombre para la categoría"})},v=c=>{S.put(`/tickets/${c}`,{estado:"completado"},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{x.fire({icon:"success",title:"Ticket completado correctamente"}),z.value=l.props.tickets},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al completar el ticket"}),console.error(l)}})},q=()=>{var c;(c=T==null?void 0:T.value)!=null&&c.tipo.trim()?(S.delete(`/categorias/${T.value.tipo}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{l.props.flash.success?(x.fire({icon:"success",title:"Categoría eliminada correctamente"}),U.value=l.props.categorias):x.fire({icon:"error",title:"La categoría tiene mas de un elemento aún en alguna sucursal"})},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al eliminar la categoría"})}}),m()):x.fire({icon:"error",title:"Por favor, selecciona una categoría"})},p=ie({id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),N=g(!1),F=g(""),Q=W(()=>{var c;return(c=w==null?void 0:w.value)==null?void 0:c.filter(l=>l.nombre.toLowerCase().includes(F.value.toLowerCase())||l.tipo.toLowerCase().includes(F.value.toLowerCase()))}),x=D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:c=>{c.onmouseenter=D.stopTimer,c.onmouseleave=D.resumeTimer}}),X=()=>{N.value?S.put(`/inventario/${p.id}`,{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Actualizado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al actualizar el ítem"})}}):S.post("/inventario",{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Agregado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar el ítem"})}})},k=c=>{Object.assign(p,c),N.value=!0},L=c=>{D.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e66f23",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&S.delete(`/inventario/${c}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:i=>{x.fire({icon:"success",title:"Eliminado correctamente"}),w.value=i.props.inventario},onError:i=>{x.fire({icon:"error",title:"Hubo un problema al eliminar el ítem"})}})})},$=()=>{Object.assign(p,{id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),N.value=!1};return(c,l)=>(r(),a("div",Tt,[l[20]||(l[20]=e("h1",{class:"text-2xl font-bold mb-4"},"Gestión de Inventario",-1)),e("div",Vt,[(r(!0),a(C,null,B(z.value,i=>(r(),a("div",{key:i.id,class:"flex flex-col gap-4 p-4 border rounded-lg shadow-sm bg-white"},[e("div",It,[e("div",Ut,[e("span",Nt,"Ticket #"+d(i.id),1),e("span",Bt,"Fecha: "+d(i.created_at.split("T")[0]),1)]),e("div",zt,[l[9]||(l[9]=P(" Estado: ")),e("span",jt,d(i.estado),1)])]),e("div",null,[e("div",At,[l[10]||(l[10]=e("span",{class:"font-medium"},"Hora de salida:",-1)),P(" "+d(i.hora_salida||"N/A"),1)]),e("div",Dt,[l[11]||(l[11]=e("h4",{class:"text-sm font-medium text-gray-800"},"Productos asignados:",-1)),e("ul",Gt,[(r(!0),a(C,null,B(i.ticket_productos_asignacion,V=>(r(),a("li",{class:"flex gap-1 items-center",key:V.id},[P(d(V.cantidad)+"x "+d(V.producto.nombre),1),V.producto.detalle?(r(),a("p",Ft,"- "+d(V.producto.detalle),1)):u("",!0)]))),128))])])]),e("div",Lt,[e("button",{onClick:V=>v(i.id),class:"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 focus:outline-none focus:ring focus:ring-orange-200 focus:ring-opacity-50"}," Completar ",8,Mt)])]))),128))]),M(f).user.roles[0]==="admin"||M(f).user.roles[0]==="sucursal"||M(f).user.roles[0]==="almacen"?(r(),a("div",Pt,[e("div",Ht,[e("div",Rt,[e("h2",Ot,d(N.value?"Editar Item":"Agregar Nuevo Item"),1),e("form",{onSubmit:de(X,["prevent"]),class:"space-y-4"},[e("div",null,[l[12]||(l[12]=e("label",{for:"itemName",class:"block text-sm font-medium text-gray-700"},"Nombre del Item",-1)),y(e("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>p.nombre=i),id:"itemName",type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.nombre]])]),e("div",null,[l[13]||(l[13]=e("label",{for:"itemCategory",class:"block text-sm font-medium text-gray-700"},"Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[1]||(l[1]=i=>p.tipo=i),id:"itemCategory",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},[(r(!0),a(C,null,B(U.value,i=>(r(),a("option",{class:"capitalize",value:i.tipo},d(i.tipo),9,qt))),256))],512),[[J,p.tipo]])]),e("div",null,[l[14]||(l[14]=e("label",{for:"itemDetalle",class:"block text-sm font-medium text-gray-700"},"Detalle del item",-1)),y(e("input",{"onUpdate:modelValue":l[2]||(l[2]=i=>p.detalle=i),id:"itemDetalle",type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.detalle]])]),e("div",null,[l[15]||(l[15]=e("label",{for:"itemQuantity",class:"block text-sm font-medium text-gray-700"},"Cantidad",-1)),y(e("input",{"onUpdate:modelValue":l[3]||(l[3]=i=>p.cantidad=i),id:"itemQuantity",type:"number",required:"",min:"0",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.cantidad,void 0,{number:!0}]])]),e("div",null,[l[16]||(l[16]=e("label",{for:"itemPrice",class:"block text-sm font-medium text-gray-700"},"Precio Unitario",-1)),y(e("input",{"onUpdate:modelValue":l[4]||(l[4]=i=>p.precio=i),id:"itemPrice",type:"number",required:"",min:"0",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.precio,void 0,{number:!0}]])]),e("div",Qt,[e("button",{type:"button",onClick:$,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-gray-700 bg-gray-200 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"}," Cancelar "),e("button",Xt,d(N.value?"Actualizar":"Agregar"),1)])],32)]),G.value?(r(),a("div",Wt,[e("button",{onClick:R,class:"bg-orange-500 w-full hover:bg-orange-700 text-white font-bold py-2 px-4 rounded mb-4"}," Agregar nueva categoría "),e("button",{onClick:n,class:"bg-red-500 w-full hover:bg-red-700 text-white font-bold py-2 px-4 rounded mb-4"}," Eliminar categoría ")])):u("",!0)]),e("div",Jt,[e("div",Kt,[y(e("input",{"onUpdate:modelValue":l[5]||(l[5]=i=>F.value=i),type:"text",placeholder:"Buscar en el inventario...",class:"w-full px-4 py-2 rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50",onInput:l[6]||(l[6]=(...i)=>c.searchInventory&&c.searchInventory(...i))},null,544),[[h,F.value]])]),e("div",Yt,[e("table",Zt,[l[17]||(l[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Categoría"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Detalle"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Existentes"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Precio"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones")])],-1)),e("tbody",eo,[(r(!0),a(C,null,B(Q.value,i=>(r(),a("tr",{key:i.id,class:"text-center"},[e("td",to,d(i.nombre),1),e("td",oo,d(i.tipo),1),e("td",so,d(i.detalle),1),e("td",ro,d(i.cantidad),1),e("td",ao,"$"+d(i.precio),1),e("td",lo,[e("button",{onClick:V=>k(i),class:"bg-orange-600 py-1 px-2 text-white rounded-lg hover:bg-orange-900 mr-2"},"Editar",8,no),e("button",{onClick:V=>L(i.id),class:"bg-red-600 py-1 px-2 text-white rounded-lg hover:bg-red-900"},"Eliminar",8,io)])]))),128))])])])])])):u("",!0),H(Et),E.value?(r(),a("div",uo,[e("div",co,[l[18]||(l[18]=e("h2",{class:"text-xl font-semibold mb-4"},"Agregar Categoría",-1)),y(e("input",{"onUpdate:modelValue":l[7]||(l[7]=i=>_.value=i),type:"text",placeholder:"Nombre de la categoría",class:"w-full mb-4 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[h,_.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:m,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:O,class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg"}," Agregar ")])])])):u("",!0),j.value?(r(),a("div",po,[e("div",go,[l[19]||(l[19]=e("h2",{class:"text-xl font-semibold mb-4"},"Eliminar Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[8]||(l[8]=i=>T.value=i),class:"w-full mb-4 px-3 py-2 border rounded-lg capitalize focus:outline-none focus:ring-2 focus:ring-orange-500"},[(r(!0),a(C,null,B(U.value,i=>(r(),a("option",{value:i,class:"capitalize"},d(i.tipo),9,vo))),256))],512),[[J,T.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:m,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:q,class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg"}," Eliminar ")])])])):u("",!0)]))}},xo={class:"py-6 px-2"},mo={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},bo={class:"bg-white overflow-hidden shadow-xl rounded-lg py-2"},ko={__name:"index",setup(K){return(f,z)=>(r(),ue(pe,{title:"Tablero principal"},{default:ce(()=>[e("div",xo,[e("div",mo,[e("div",bo,[H(fo)])])])]),_:1}))}};export{ko as default};
