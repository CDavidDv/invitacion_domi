import{o as r,e as d,a as e,t as a,n as c,F as S,h as A,g as u,f as C,Q as z,d as g,k as F,j as M,v as P,l as U,b as w,z as L,c as O,w as Q}from"./app-DkSrmlCF.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as T,_ as R}from"./AppLayout-BExXXgMM.js";const G={class:"p-6 text-left border shadow-lg rounded-xl bg-white"},J={key:0},K={class:"overflow-y-auto scrollbar-thin divide-y divide-gray-200",style:{"max-height":"25rem"}},W={class:"w-full h-full"},X={class:"w-1/4 my-auto h-full flex flex-col gap-2 items-center justify-center"},Y=["onClick"],Z=["onClick"],ee={__name:"TicketCard",props:{title:{type:String,required:!0},tickets:{type:Array,required:!0},textColor:{type:String,default:"gray-800"},tipo:{type:String,default:"asignar"},emptyMessage:{type:String,default:""}},emits:["view-ticket-details","cancel-ticket"],setup(l,{emit:m}){const v=m,p=b=>{v("view-ticket-details",b)},y=b=>{v("cancel-ticket",b)};return(b,n)=>(r(),d("div",G,[e("h2",{class:c(["text-xl font-semibold mb-4",{"text-yellow-500":l.tipo==="asignar","text-green-500":l.tipo==="cerrar","text-red-500":l.tipo==="cancelar"}])},a(l.title),3),l.tickets.length?(r(),d("div",J,[e("ul",K,[(r(!0),d(S,null,A(l.tickets,s=>{var x,f;return r(),d("li",{key:s.id,class:c(["p-4 flex justify-between items-start bg-gradient-to-br rounded-lg mb-2",{"from-yellow-50 to-yellow-100":l.tipo==="asignar","from-green-50 to-green-100":l.tipo==="cerrar","from-red-50 to-red-100":l.tipo==="cancelar"}])},[e("div",W,[e("p",{class:c(`text-sm text-${l.textColor}`)},[n[0]||(n[0]=e("strong",null,"ID:",-1)),u(" "+a(s.id),1)],2),e("p",{class:c(`text-sm text-${l.textColor}`)},[n[1]||(n[1]=e("strong",null,"Empleado:",-1)),u(" "+a(((x=s==null?void 0:s.usuario)==null?void 0:x.name)||"No asignado"),1)],2),e("p",{class:c(`text-sm text-${l.textColor}`)},[n[2]||(n[2]=e("strong",null,"Sucursal destino:",-1)),u(" "+a(((f=s==null?void 0:s.sucursal)==null?void 0:f.nombre)||"Sin destino"),1)],2),e("p",{class:c(`text-sm text-${l.textColor}`)},[n[3]||(n[3]=e("strong",null,"Hora salida:",-1)),u(" "+a(s.hora_salida||"N/A"),1)],2),s.hora_llegada?(r(),d("p",{key:0,class:c(`text-sm text-${l.textColor}`)},[n[4]||(n[4]=e("strong",null,"Hora llegada:",-1)),u(" "+a(s.hora_llegada),1)],2)):C("",!0)]),e("div",X,[e("button",{class:"text-sm bg-blue-400 hover:bg-blue-500 text-gray-50 py-1 px-2 rounded-xl",onClick:k=>p(s)}," Ver detalles ",8,Y),l.tipo==="asignar"?(r(),d("button",{key:0,class:"text-sm bg-red-400 hover:bg-red-500 text-gray-50 py-1 px-2 rounded-xl ml-2",onClick:k=>y(s)}," Cancelar ",8,Z)):C("",!0)])],2)}),128))])])):(r(),d("p",{key:1,class:c(`text-${l.textColor}`)},a(l.emptyMessage||"No hay tickets en esta categorÃ­a"),3))]))}},$=_(ee,[["__scopeId","data-v-ed63fe97"]]),te={class:"p-10 min-h-screen bg-gray-50"},se={class:"flex flex-col md:flex-row justify-between items-center mb-8"},le={class:"flex flex-col"},oe={class:"flex flex-col"},ae=["value"],re={class:"container mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},ne={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ie={class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-screen-lg overflow-y-auto max-h-screen"},de={class:"space-y-4"},ue={key:0},ce={class:"mt-6"},ge={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-2"},me={__name:"TicketsAsignados",setup(l){const{props:m}=z(),v=g(m.ticketsCerrados),p=g(m.ticketsAsignados),y=g(m.ticketsCancelados),b=g(m.sucursales),n=g(!1),s=g(null),x=g(""),f=g(""),k=i=>{s.value=i,n.value=!0},q=()=>{n.value=!1,s.value=null},H=i=>{L.post("/tickets/cancelar",{ticket:i.id},{preserveScroll:!0,onSuccess:t=>{p.value=t.props.ticketsAsignados,y.value=t.props.ticketsCancelados},onError:t=>{console.error("Error al cancelar el ticket:",t)}})},h=T.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:i=>{i.onmouseenter=T.stopTimer,i.onmouseleave=T.resumeTimer}}),I=()=>{if(!x.value||!f.value){h.fire({icon:"error",title:"Por favor, seleccione una fecha y una sucursal"});return}axios.post("/tickets/buscar",{fecha:x.value,sucursal:f.value}).then(i=>{p.value=i.data.ticketsAsignados,v.value=i.data.ticketsCerrados,y.value=i.data.ticketsCancelados,console.log(i.data),h.fire({icon:"success",title:"Tickets encontrados"})}).catch(i=>{console.error("Error al buscar tickets:",i),h.fire({icon:"error",title:"Error al buscar tickets"})})};return(i,t)=>{var D,E,N,V;return r(),d("div",te,[e("div",se,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-800"},"Tarjetas Recientes",-1)),e("form",{onSubmit:F(I,["prevent"]),class:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0"},[e("div",le,[t[2]||(t[2]=e("label",{for:"fecha",class:"text-sm font-medium text-gray-700 mb-1"},"Buscar por fecha",-1)),M(e("input",{type:"date",id:"fecha","onUpdate:modelValue":t[0]||(t[0]=o=>x.value=o),required:"",class:"p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[P,x.value]])]),e("div",oe,[t[5]||(t[5]=e("label",{for:"sucursal",class:"text-sm font-medium text-gray-700 mb-1"},"Buscar por sucursal",-1)),M(e("select",{id:"sucursal","onUpdate:modelValue":t[1]||(t[1]=o=>f.value=o),required:"",class:"py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},[t[3]||(t[3]=e("option",{value:""},"Seleccione sucursal",-1)),t[4]||(t[4]=e("option",{value:"todas"},"Todas",-1)),(r(!0),d(S,null,A(b.value,o=>(r(),d("option",{key:o.id,value:o.id},a(o.nombre),9,ae))),128))],512),[[U,f.value]])]),t[6]||(t[6]=e("button",{type:"submit",class:"mt-6 md:mt-0 px-4 h-fit py-2 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition"}," Buscar ",-1))],32)]),e("div",re,[w($,{title:"Entregas Asignados",tickets:p.value,tipo:"asignar",onViewTicketDetails:k,onCancelTicket:H},null,8,["tickets"]),w($,{title:"Entregas Completados",tickets:v.value,tipo:"cerrar",onViewTicketDetails:k},null,8,["tickets"]),w($,{title:"Entregas Cancelados",tickets:y.value,tipo:"cancelar",onViewTicketDetails:k},null,8,["tickets"])]),n.value?(r(),d("div",ne,[e("div",ie,[t[17]||(t[17]=e("h3",{class:"text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4"}," Detalles del Ticket ",-1)),e("div",de,[e("p",null,[t[8]||(t[8]=e("strong",{class:"font-semibold"},"ID:",-1)),u(" "+a(s.value.id),1)]),e("p",null,[t[9]||(t[9]=e("strong",{class:"font-semibold"},"Empleado:",-1)),u(" "+a(((E=(D=s.value)==null?void 0:D.usuario)==null?void 0:E.name)||"No asignado"),1)]),e("p",null,[t[10]||(t[10]=e("strong",{class:"font-semibold"},"Sucursal destino:",-1)),u(" "+a(((V=(N=s.value)==null?void 0:N.sucursal)==null?void 0:V.nombre)||"Sin destino"),1)]),e("p",null,[t[11]||(t[11]=e("strong",{class:"font-semibold"},"Hora salida:",-1)),u(" "+a(s.value.hora_salida||"N/A"),1)]),s.value.hora_llegada?(r(),d("p",ue,[t[12]||(t[12]=e("strong",{class:"font-semibold"},"Hora llegada:",-1)),u(" "+a(s.value.hora_llegada),1)])):C("",!0)]),e("div",ce,[t[16]||(t[16]=e("span",{class:"font-semibold text-lg text-gray-800"},"Productos:",-1)),e("ul",ge,[(r(!0),d(S,null,A(s.value.ticket_productos_asignacion,o=>{var B,j;return r(),d("li",{key:o.id,class:"p-4 border rounded-lg shadow-sm hover:shadow-md transition"},[e("p",null,[t[13]||(t[13]=e("strong",null,"Nombre:",-1)),u(" "+a((B=o==null?void 0:o.producto)==null?void 0:B.nombre),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Tipo:",-1)),u(" "+a((j=o==null?void 0:o.producto)==null?void 0:j.tipo),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Cantidad:",-1)),u(" "+a(o==null?void 0:o.cantidad),1)])])}),128))])]),e("div",{class:"flex justify-center mt-6"},[e("button",{class:"px-6 py-2 bg-red-500 text-white font-semibold text-sm rounded-lg hover:bg-red-600 transition",onClick:q}," Cerrar ")])])])):C("",!0)])}}},xe=_(me,[["__scopeId","data-v-a2aad5dc"]]),fe={class:"py-6 px-2"},ve={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},be={class:"bg-white overflow-hidden shadow-xl rounded-lg py-2"},we={__name:"index",setup(l){return(m,v)=>(r(),O(R,{title:"Tablero principal"},{default:Q(()=>[e("div",fe,[e("div",ve,[e("div",be,[w(xe)])])])]),_:1}))}};export{we as default};
