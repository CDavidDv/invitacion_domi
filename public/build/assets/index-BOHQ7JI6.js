import{_ as M}from"./AppLayout-Cf0VGVC6.js";import{z as j,d as v,k as g,s as z,Q as R,o as l,e as i,a,F as _,h as H,t as u,i as $,l as B,y as E,q as A,u as c,A as D,c as F,w as I,b as N}from"./app-054imNZ6.js";import{S as p}from"./sweetalert2.esm.all-BGf-Fe8G.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const V=j("timerStore",()=>{const x=v(!1),t=v([]),b=v(0),f=v(0),m=v([]),h=v(null),T=g(()=>b.value-f.value),y=d=>{m.value.push(d)},s=d=>d.masa==="bola"?18e5:d.masa==="salada"||d.masa==="dulce"?24e5:18e5,P=()=>{if(m.value.length===0||x.value)return;x.value=!0,t.value=[...m.value],m.value=[],b.value=s(t.value[0]),h.value=Date.now();const d=setInterval(()=>{f.value=Date.now()-h.value,f.value>=b.value&&S(d)},100)},S=d=>{clearInterval(d);const n=[...t.value];x.value=!1,t.value=[],f.value=0,w(),z.post("/hornear",{pastes:n},{onSuccess:()=>{p.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:o=>{o.onmouseenter=p.stopTimer,o.onmouseleave=p.resumeTimer}}).fire({icon:"success",title:"Registrado correctamente"})},onError:e=>{console.error("Error al registrar el horneado:",e),p.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:r=>{r.onmouseenter=p.stopTimer,r.onmouseleave=p.resumeTimer}}).fire({icon:"error",title:"Error al registrar"})}})},w=()=>{new Audio("/sound/videoplayback.mp3").play().catch(n=>console.log("Error al reproducir el sonido:",n))};return{horneando:x,pastesHorneando:t,tiempoTotal:b,tiempoTranscurrido:f,tiempoRestante:T,pastesPorHornear:m,agregarPaste:y,iniciarHorneado:P,cancelarPaste:d=>{const n=m.value.findIndex(e=>e.id===d);n!==-1&&m.value.splice(n,1)}}}),q={class:"container mx-auto p-4"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},U={class:"bg-white shadow rounded-lg p-6"},G={class:"mb-6"},L={class:"list-disc pl-5"},Q={class:"font-semibold"},Z={class:"list-disc pl-5"},J={class:"font-semibold"},K={class:"bg-white shadow rounded-lg p-6"},W=["value"],X=["max"],Y=["disabled"],ee={class:"mt-8 bg-white shadow rounded-lg p-6"},oe={key:0},ae={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-4"},ne={key:1},te=["disabled"],se={class:"mt-8 bg-white shadow rounded-lg p-6"},re={key:0,class:"text-gray-500 text-center py-4"},le={key:1,class:"divide-y divide-gray-200"},ie=["onClick"],de={__name:"Hornear",setup(x){const t=V(),{props:b}=R(),f=b.inventario,m=g(()=>f.filter(n=>n.tipo==="masa")),h=g(()=>f.filter(n=>n.tipo==="relleno")),T=g(()=>m.value.map(n=>{const e=t.pastesHorneando.filter(o=>o.masa===n.nombre).reduce((o,r)=>o+r.cantidad,0);return{...n,cantidad:n.cantidad-e}})),y=g(()=>h.value.map(n=>{const e=t.pastesHorneando.filter(o=>o.nombre===n.nombre).reduce((o,r)=>o+r.cantidad,0);return{...n,cantidad:n.cantidad-e}})),s=v({masa:"",relleno:"",cantidad:1}),P=n=>({"Papa con carne":"bola","Crema con pollo":"bola","Frijol con chorizo":"bola","Mole rojo":"salada","Mole verde":"salada",Salchicha:"salada",Tinga:"salada",Minero:"salada",Atún:"salada",Choriqueso:"salada","Rajas con champiñones":"salada",Hawaiano:"dulce","Arroz con leche":"dulce",Piña:"dulce",Manzana:"dulce",Zarzamora:"dulce",Cajeta:"dulce",Fresa:"dulce",Budin:"dulce"})[n]||"",S=()=>{const n=P(s.value.relleno),e=T.value.find(r=>r.nombre===n),o=y.value.find(r=>r.nombre===s.value.relleno);if(!e||e.cantidad<=0){p.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:k=>{k.onmouseenter=p.stopTimer,k.onmouseleave=p.resumeTimer}}).fire({icon:"error",title:"No hay masa suficiente"});return}if(e&&o&&s.value.cantidad<=w.value){e.cantidad-=s.value.cantidad,o.cantidad-=s.value.cantidad;const r=t.pastesPorHornear.find(k=>k.nombre===o.nombre);r?r.cantidad+=s.value.cantidad:t.agregarPaste({id:Date.now(),masa:e.nombre,nombre:o.nombre,cantidad:s.value.cantidad}),s.value={masa:"",relleno:"",cantidad:1}}},w=g(()=>{const n=y.value.find(e=>e.nombre===s.value.relleno);return n?n.cantidad:1}),C=g(()=>s.value.relleno&&s.value.cantidad>0&&s.value.cantidad<=w.value),d=n=>{const e=Math.ceil(n/1e3),o=Math.floor(e/60),r=e%60;return`${o}:${r.toString().padStart(2,"0")}`};return(n,e)=>(l(),i("div",q,[e[14]||(e[14]=a("h1",{class:"text-2xl font-bold mb-4"},"Sistema de Horneado",-1)),a("div",O,[a("div",U,[e[5]||(e[5]=a("h2",{class:"text-xl font-semibold mb-4"},"Ingredientes Disponibles",-1)),a("div",G,[e[3]||(e[3]=a("h3",{class:"text-lg font-medium mb-2"},"Masas",-1)),a("ul",L,[(l(!0),i(_,null,H(T.value,o=>(l(),i("li",{key:o.id,class:"flex justify-between"},[a("span",null,u(o.nombre),1),a("span",Q,u(o.cantidad)+" unidades",1)]))),128))])]),a("div",null,[e[4]||(e[4]=a("h3",{class:"text-lg font-medium mb-2"},"Rellenos",-1)),a("ul",Z,[(l(!0),i(_,null,H(y.value,o=>(l(),i("li",{key:o.id,class:"flex justify-between"},[a("span",null,u(o.nombre),1),a("span",J,u(o.cantidad)+" unidades",1)]))),128))])])]),a("div",K,[e[9]||(e[9]=a("h2",{class:"text-xl font-semibold mb-4"},"Crear Nuevo Paste/Empanada",-1)),a("form",{onSubmit:$(S,["prevent"]),class:"space-y-4"},[a("div",null,[e[7]||(e[7]=a("label",{for:"relleno",class:"block text-sm font-medium text-gray-700"},"Seleccionar Relleno",-1)),B(a("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.relleno=o),id:"relleno",required:"",class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md"},[e[6]||(e[6]=a("option",{value:""},"Seleccione un relleno",-1)),(l(!0),i(_,null,H(h.value,o=>(l(),i("option",{key:o.id,value:o.nombre},u(o.nombre),9,W))),128))],512),[[E,s.value.relleno]])]),a("div",null,[e[8]||(e[8]=a("label",{for:"cantidad",class:"block text-sm font-medium text-gray-700"},"Cantidad",-1)),B(a("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.cantidad=o),type:"number",id:"cantidad",required:"",min:"1",max:w.value,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 sm:text-sm"},null,8,X),[[A,s.value.cantidad,void 0,{number:!0}]])]),a("button",{type:"submit",disabled:!C.value,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Asignar Unidades ",8,Y)],32)])]),a("div",ee,[e[12]||(e[12]=a("h2",{class:"text-xl font-semibold mb-4"},"Horno",-1)),c(t).horneando?(l(),i("div",oe,[e[10]||(e[10]=a("p",{class:"text-lg mb-2"}," Horneando grupo de pastes: ",-1)),a("ul",null,[(l(!0),i(_,null,H(c(t).pastesHorneando,o=>(l(),i("li",{key:o.nombre},u(o.cantidad)+" "+u(o.nombre)+" - masa "+u(o.masa),1))),128))]),a("div",ae,[a("div",{class:"bg-orange-600 h-2.5 rounded-full transition-all duration-100",style:D({width:`${c(t).tiempoTranscurrido/c(t).tiempoTotal*100}%`})},null,4)]),a("p",null,"Tiempo restante: "+u(d(c(t).tiempoRestante)),1)])):(l(),i("div",ne,[e[11]||(e[11]=a("p",{class:"text-lg mb-4"},"El horno está disponible",-1)),a("button",{onClick:e[2]||(e[2]=(...o)=>c(t).iniciarHorneado&&c(t).iniciarHorneado(...o)),disabled:!c(t).pastesPorHornear.length,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Iniciar Horneado de Grupo ",8,te)]))]),a("div",se,[e[13]||(e[13]=a("h2",{class:"text-xl font-semibold mb-4"},"Grupos de Pastes por Hornear",-1)),c(t).pastesPorHornear.length===0?(l(),i("div",re," No hay grupos de pastes en la cola de horneado ")):(l(),i("ul",le,[(l(!0),i(_,null,H(c(t).pastesPorHornear,o=>(l(),i("li",{key:o.id,class:"py-4 flex justify-between items-center"},[a("span",null,u(o.cantidad)+" "+u(o.nombre)+" - masa "+u(o.masa),1),a("button",{onClick:r=>c(t).cancelarPaste(o.id),class:"bg-red-600 text-white hover:bg-red-800 rounded-lg px-2 py-1 focus:outline-none focus:underline"}," Cancelar ",8,ie)]))),128))]))])]))}},ue={class:"py-6"},ce={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 rounded-xl overflow-hidden"},me={class:"flex justify-between p-6 lg:p-8 bg-white border-b border-gray-200 rounded-2xl"},ge={__name:"index",setup(x){return(t,b)=>(l(),F(M,{title:"Tablero principal"},{default:I(()=>[a("div",ue,[a("div",ce,[a("div",me,[N(de)])])])]),_:1}))}};export{ge as default};
